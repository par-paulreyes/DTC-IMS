(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{2023:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var l=a(3365),t=a(1521),r=a(627),n=a(8660),d=a(5611);function o(){let[e,s]=(0,t.useState)(null),[a,o]=(0,t.useState)({}),[i,m]=(0,t.useState)(!0),[c,u]=(0,t.useState)(!1),[p,b]=(0,t.useState)(""),[h,x]=(0,t.useState)(""),f=(0,r.useRouter)();(0,t.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void f.push("/login");n.A.get((0,d.e9)("/users/profile"),{headers:{Authorization:e}}).then(e=>{s(e.data),o({...e.data,password:"",confirmPassword:""})}).catch(e=>b("Error loading profile")).finally(()=>m(!1))},[f]);let w=e=>{o({...a,[e.target.name]:e.target.value})},g=async e=>{if(e.preventDefault(),b(""),x(""),a.password&&a.password!==a.confirmPassword)return void b("Passwords do not match");u(!0);let s=localStorage.getItem("token");try{await n.A.put((0,d.e9)("/users/profile"),a.password?{...a,password:a.password}:a,{headers:{Authorization:s}}),x("Profile updated successfully!"),o({...a,password:"",confirmPassword:""})}catch(e){var l,t;b((null==(t=e.response)||null==(l=t.data)?void 0:l.message)||"Error updating profile")}finally{u(!1)}};return i?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):p?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center text-red-500",children:p}):e?(0,l.jsxs)("div",{className:"min-h-screen pt-8 pb-20 bg-gray-50",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Profile"}),(0,l.jsxs)("form",{onSubmit:g,className:"max-w-md mx-auto bg-white rounded shadow p-6",children:[p&&(0,l.jsx)("div",{className:"mb-4 text-red-500",children:p}),h&&(0,l.jsx)("div",{className:"mb-4 text-green-600",children:h}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Username"}),(0,l.jsx)("input",{type:"text",name:"username",className:"w-full border rounded px-3 py-2 bg-gray-100",value:a.username||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Full Name"}),(0,l.jsx)("input",{type:"text",name:"full_name",className:"w-full border rounded px-3 py-2",value:a.full_name||"",onChange:w,required:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Email"}),(0,l.jsx)("input",{type:"email",name:"email",className:"w-full border rounded px-3 py-2",value:a.email||"",onChange:w,required:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Role"}),(0,l.jsx)("input",{type:"text",name:"role",className:"w-full border rounded px-3 py-2 bg-gray-100",value:a.role||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Company"}),(0,l.jsx)("input",{type:"text",name:"company_name",className:"w-full border rounded px-3 py-2 bg-gray-100",value:a.company_name||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"New Password"}),(0,l.jsx)("input",{type:"password",name:"password",className:"w-full border rounded px-3 py-2",value:a.password||"",onChange:w,placeholder:"Leave blank to keep current password"})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"Confirm New Password"}),(0,l.jsx)("input",{type:"password",name:"confirmPassword",className:"w-full border rounded px-3 py-2",value:a.confirmPassword||"",onChange:w,placeholder:"Leave blank to keep current password"})]}),(0,l.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition",disabled:c,children:c?"Saving...":"Update Profile"})]}),(null==e?void 0:e.role)==="admin"&&(0,l.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded shadow p-6 mt-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold mb-4 text-center",children:"Admin Actions"}),(0,l.jsx)("button",{onClick:()=>f.push("/register"),className:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition",children:"Register New User"})]}),(0,l.jsx)("div",{className:"max-w-md mx-auto mt-6",children:(0,l.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),f.push("/login")},className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition",children:"Logout"})})]}):(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Profile not found."})}},5611:(e,s,a)=>{"use strict";a.d(s,{VG:()=>r,e9:()=>t});let l=a(4089).env.NEXT_PUBLIC_API_URL||"http://192.168.100.188:5000",t=e=>"".concat(l,"/api").concat(e),r=e=>e?e.startsWith("http")?e:"".concat(l).concat(e):""},9740:(e,s,a)=>{Promise.resolve().then(a.bind(a,2023))}},e=>{var s=s=>e(e.s=s);e.O(0,[602,347,870,358],()=>s(9740)),_N_E=e.O()}]);