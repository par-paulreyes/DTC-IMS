(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{5075:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>m});var r=a(3365),l=a(1521),n=a(627),t=a(8660),i=a(5611);function m(){let[e,s]=(0,l.useState)({username:"",full_name:"",email:"",password:"",confirmPassword:"",company_name:""}),[a,m]=(0,l.useState)(""),[d,o]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),p=(0,n.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void p.push("/login");t.A.get((0,i.e9)("/users/profile"),{headers:{Authorization:e}}).then(e=>{u(e.data),"admin"!==e.data.role&&(m("Access denied. Admin privileges required."),setTimeout(()=>{p.push("/")},2e3))}).catch(e=>{var s;(null==(s=e.response)?void 0:s.status)===401?(localStorage.removeItem("token"),p.push("/login")):m("Error verifying permissions")}).finally(()=>{o(!1)})},[p]);let h=async s=>{if(s.preventDefault(),e.password!==e.confirmPassword)return void m("Passwords do not match");if((null==c?void 0:c.role)!=="admin")return void m("Access denied. Admin privileges required.");o(!0),m("");try{let s=localStorage.getItem("token");await t.A.post((0,i.e9)("/auth/register"),{username:e.username,full_name:e.full_name,email:e.email,password:e.password,company_name:e.company_name},{headers:{Authorization:s}}),p.push("/inventory")}catch(e){var a,r;m((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"Registration failed")}finally{o(!1)}};return d?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("div",{className:"text-blue-600 mb-2",children:"Verifying permissions..."})})}):(null==c?void 0:c.role)!=="admin"?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Admin privileges required to access this page."}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting to dashboard..."})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,r.jsxs)("form",{onSubmit:h,className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Register User (Admin Only)"}),a&&(0,r.jsx)("div",{className:"mb-4 text-red-500",children:a}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",className:"w-full border rounded px-3 py-2",value:e.username,onChange:a=>s({...e,username:a.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Full Name"}),(0,r.jsx)("input",{type:"text",name:"full_name",className:"w-full border rounded px-3 py-2",value:e.full_name,onChange:a=>s({...e,full_name:a.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",className:"w-full border rounded px-3 py-2",value:e.email,onChange:a=>s({...e,email:a.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Company Name"}),(0,r.jsx)("input",{type:"text",name:"company_name",className:"w-full border rounded px-3 py-2",value:e.company_name,onChange:a=>s({...e,company_name:a.target.value}),placeholder:"e.g., DTC",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Password"}),(0,r.jsx)("input",{type:"password",name:"password",className:"w-full border rounded px-3 py-2",value:e.password,onChange:a=>s({...e,password:a.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",name:"confirmPassword",className:"w-full border rounded px-3 py-2",value:e.confirmPassword,onChange:a=>s({...e,confirmPassword:a.target.value}),required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition",disabled:d,children:d?"Registering...":"Register User"})]})})}},5611:(e,s,a)=>{"use strict";a.d(s,{VG:()=>n,e9:()=>l});let r=a(4089).env.NEXT_PUBLIC_API_URL||"http://192.168.100.188:5000",l=e=>"".concat(r,"/api").concat(e),n=e=>e?e.startsWith("http")?e:"".concat(r).concat(e):""},8528:(e,s,a)=>{Promise.resolve().then(a.bind(a,5075))}},e=>{var s=s=>e(e.s=s);e.O(0,[602,347,870,358],()=>s(8528)),_N_E=e.O()}]);