(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4415:(e,t,s)=>{Promise.resolve().then(s.bind(s,7417))},5611:(e,t,s)=>{"use strict";s.d(t,{VG:()=>i,e9:()=>l});let a=s(4089).env.NEXT_PUBLIC_API_URL||"http://192.168.100.188:5000",l=e=>"".concat(a,"/api").concat(e),i=e=>e?e.startsWith("http")?e:"".concat(a).concat(e):""},7417:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(3365),l=s(1521),i=s(627),n=s(8660),c=s(5611);function r(){let[e,t]=(0,l.useState)(0),[s,r]=(0,l.useState)(0),[d,o]=(0,l.useState)(0),[h,x]=(0,l.useState)(!0),[m,u]=(0,l.useState)(""),g=(0,i.useRouter)();return(0,l.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void g.push("/login");x(!0),u(""),Promise.all([n.A.get((0,c.e9)("/items"),{headers:{Authorization:e}}),n.A.get((0,c.e9)("/items/maintenance/upcoming"),{headers:{Authorization:e}})]).then(s=>{let[a,l]=s;t(a.data.length),r(l.data.length);let i=a.data.map(e=>e.id);if(0===i.length){o(0),x(!1);return}Promise.all(i.map(t=>n.A.get((0,c.e9)("/diagnostics/item/".concat(t)),{headers:{Authorization:e}}))).then(e=>{o(e.reduce((e,t)=>e+t.data.filter(e=>e.system_status&&(e.system_status.toLowerCase().includes("fail")||e.system_status.toLowerCase().includes("issue")||e.system_status.toLowerCase().includes("problem"))).length,0))}).catch(()=>o(0)).finally(()=>x(!1))}).catch(e=>{u("Error loading dashboard stats"),x(!1)})},[g]),(0,a.jsxs)("div",{className:"min-h-screen pt-8 pb-20 bg-gray-50",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Dashboard"}),h&&(0,a.jsx)("div",{className:"text-center text-blue-600",children:"Loading..."}),m&&(0,a.jsx)("div",{className:"text-center text-red-500",children:m}),!h&&!m&&(0,a.jsxs)("div",{className:"max-w-xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded shadow p-6 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:e}),(0,a.jsx)("div",{className:"text-gray-600 mt-2 text-center",children:"Total Items"})]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-6 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-yellow-500",children:s}),(0,a.jsx)("div",{className:"text-gray-600 mt-2 text-center",children:"Needing Maintenance"})]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-6 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-red-500",children:d}),(0,a.jsx)("div",{className:"text-gray-600 mt-2 text-center",children:"Items with Issues"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[602,347,870,358],()=>t(4415)),_N_E=e.O()}]);